Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 "       ",
 StyleBox["xLightCone",
  FontSize->36],
 StyleBox["    ",
  FontSize->24]
}], "Title",
 InitializationCell->True,
 FontSize->48],

Cell[CellGroupData[{

Cell["Authors", "Subsection",
 InitializationCell->True,
 FontSize->18],

Cell["Obinna Umeh", "Text"],

Cell[CellGroupData[{

Cell["Dates and versions", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Date", "[", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2014", ",", "9", ",", "26", ",", "11", ",", "23", ",", 
   "43.964404`8.395676167486464"}], "}"}]], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"xAct`xLightCone`$Version", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<0.0.1\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2014", ",", "09", ",", "25"}], "}"}]}], "}"}]}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xAct`xLightCone`$xTensorVersionExpected", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<1.0.5\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2013", ",", "1", ",", "27"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`xLightCone`$xPertVersionExpected", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<1.0.3\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"2013", ",", "1", ",", "27"}], "}"}]}], "}"}]}], 
  ";"}]}], "Input",
 InitializationCell->True],

Cell["", "Text"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1. Initialization", "Subsection",
 InitializationCell->True,
 FontColor->RGBColor[
  0.20389105058365758`, 0.38530556191348136`, 0.9685969329365988]],

Cell[CellGroupData[{

Cell["1.1. GPL", "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"xPand", ":", " ", 
    RowBox[{
     RowBox[{
     "Cosmological", " ", "perturbations", " ", "about", " ", "homogeneous", 
      " ", "space"}], "-", "times"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Copyright", " ", 
      RowBox[{"(", "C", ")"}], " ", "2012"}], "-", 
     RowBox[{"2013", " ", "Cyril", " ", "Pitrou"}]}], ",", " ", 
    RowBox[{"Xavier", " ", "Roy", " ", "and", " ", "Obinna", " ", "Umeh"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "This", " ", "program", " ", "is", " ", "free", " ", "software"}], ";", 
     " ", 
     RowBox[{"you", " ", "can", " ", "redistribute", " ", "it", " ", 
      RowBox[{"and", "/", "or"}], "\[IndentingNewLine]", " ", "modify", " ", 
      "it", " ", "under", " ", "the", " ", "terms", " ", "of", " ", "the", 
      " ", "GNU", " ", "General", " ", "Public", " ", "License", " ", "as", 
      "\[IndentingNewLine]", " ", "published", " ", "by", " ", "the", " ", 
      "Free", " ", "Software", " ", "Foundation"}], ";", " ", 
     RowBox[{
     "either", " ", "version", " ", "2", " ", "of", "\[IndentingNewLine]", 
      " ", "the", " ", "License"}]}], ",", 
    RowBox[{"or", " ", 
     RowBox[{"(", 
      RowBox[{"at", " ", "your", " ", "option"}], ")"}], " ", "any", " ", 
     "later", " ", 
     RowBox[{
     "version", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "This"}], 
     " ", "program", " ", "is", " ", "distributed", " ", "in", " ", "the", 
     " ", "hope", " ", "that", " ", "it", " ", "will", " ", "be", " ", 
     "useful"}], ",", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"but", " ", "WITHOUT", " ", "ANY", " ", "WARRANTY"}], ";", " ", 
     RowBox[{
     "without", " ", "even", " ", "the", " ", "implied", " ", "warranty", " ",
       "of", "\[IndentingNewLine]", " ", "MERCHANTABILITY", " ", "or", " ", 
      "FITNESS", " ", "FOR", " ", "A", " ", "PARTICULAR", " ", 
      RowBox[{"PURPOSE", ".", " ", "See"}], " ", "the", " ", "GNU", 
      "\[IndentingNewLine]", " ", "General", " ", "Public", " ", "License", 
      " ", "for", " ", "more", " ", 
      RowBox[{
      "details", ".", "\[IndentingNewLine]", "\[IndentingNewLine]", "You"}], 
      " ", "should", " ", "have", " ", "received", " ", "a", " ", "copy", " ",
       "of", " ", "the", " ", "GNU", " ", "General", " ", "Public", " ", 
      "License", "\[IndentingNewLine]", " ", "along", " ", "with", " ", 
      "this", " ", "program"}], ";", " ", 
     RowBox[{"if", " ", "not"}]}], ",", " ", 
    RowBox[{
    "write", " ", "to", " ", "the", " ", "Free", " ", "Software", 
     "\[IndentingNewLine]", " ", "Foundation"}], ",", " ", 
    RowBox[{"Inc", "."}], ",", " ", 
    RowBox[{
     RowBox[{"59", " ", "Temple", " ", "Place"}], "-", 
     RowBox[{"Suite", " ", "330"}]}], ",", " ", "Boston", ",", " ", 
    RowBox[{
     RowBox[{"MA", " ", "02111"}], "-", "1307"}], ",", "\[IndentingNewLine]", 
    "  ", 
    RowBox[{"USA", "."}]}], " ", "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True],

Cell["", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.2. Info package", "Subsubsection"],

Cell["\<\
(* :Title: xLightCone *)

(* :Author: Obinna Umeh *)

(* :Context: xAct`xLightCone` *)

(* :Copyright: Obinna Umeh (2015-) *)

(* :Keywords: *)

(* :Source: xLightCone.nb *)

(* :Warning: *)

(* :Mathematica Version: 9.0 and later *)

(* :Limitations: *)\
\>", "Input",
 PageWidth->PaperWidth,
 CellMargins->{{60, -272}, {Inherited, Inherited}},
 InitializationCell->True],

Cell["", "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.3. Begin package", "Subsubsection"],

Cell["\<\

Decide what is the last package being read:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Unevaluated", "[", "xAct`xCore`Private`$LastPackage", "]"}], "===",
      "xAct`xCore`Private`$LastPackage"}], ",", 
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "=", "\"\<xAct`xLightCone`\>\""}]}], 
   "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["xAct`xCore`Private`$LastPackage"], "Input"],

Cell[BoxData["\<\"xAct`xLightCone`\"\>"], "Output"]
}, Open  ]],

Cell["\<\

Explicit (not hidden) import of other packages:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Off", "[", 
  StyleBox[
   RowBox[{"General", "::", "nostdvar"}], "MessageName"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Off", "[", 
  StyleBox[
   RowBox[{"General", "::", "nostdopt"}], "MessageName"], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"BeginPackage", "[", 
  RowBox[{"\"\<xAct`xLightCone`\>\"", ",", 
   RowBox[{"{", 
    RowBox[{
    "\"\<xAct`xPert`\>\"", ",", "\"\<xAct`xTensor`\>\"", ",", 
     "\"\<xAct`xPerm`\>\"", ",", "\"\<xAct`xCore`\>\"", ",", 
     "\"\<xAct`ExpressionManipulation`\>\""}], "}"}]}], "]"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPerm`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.2.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "2", ",", "15"}], "}"}]}],
  SequenceForm["Package xAct`xPerm`  version ", "1.2.1", ", ", {2014, 2, 15}],
  
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2003-2014, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"Connecting to external linux executable...\"\>"], "Print"],

Cell[BoxData["\<\"Connection established.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xTensor`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.1.0\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "2", ",", "23"}], "}"}]}],
  SequenceForm[
  "Package xAct`xTensor`  version ", "1.1.0", ", ", {2014, 2, 23}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2002-2014, Jose M. Martin-Garcia, under the \
General Public License.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xPert`  version \"\>", 
   "\[InvisibleSpace]", "\<\"1.0.4\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "2", ",", "15"}], "}"}]}],
  SequenceForm["Package xAct`xPert`  version ", "1.0.4", ", ", {2014, 2, 15}],
  
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2005-2014, David Brizuela, Jose M. \
Martin-Garcia and Guillermo A. Mena Marugan, under the General Public \
License.\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** Variable \"\>", "\[InvisibleSpace]", "$PrePrint", 
   "\[InvisibleSpace]", "\<\" assigned value \"\>", "\[InvisibleSpace]", 
   "ScreenDollarIndices"}],
  SequenceForm[
  "** Variable ", $PrePrint, " assigned value ", 
   xAct`xTensor`ScreenDollarIndices],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** Variable \"\>", "\[InvisibleSpace]", "$CovDFormat", 
   "\[InvisibleSpace]", "\<\" changed from \"\>", 
   "\[InvisibleSpace]", "\<\"Prefix\"\>", "\[InvisibleSpace]", "\<\" to \"\>",
    "\[InvisibleSpace]", "\<\"Postfix\"\>"}],
  SequenceForm[
  "** Variable ", xAct`xTensor`$CovDFormat, " changed from ", "Prefix", 
   " to ", "Postfix"],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** Option \"\>", "\[InvisibleSpace]", "AllowUpperDerivatives", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "ContractMetric",
    "\[InvisibleSpace]", "\<\" changed from \"\>", "\[InvisibleSpace]", 
   "False", "\[InvisibleSpace]", "\<\" to \"\>", "\[InvisibleSpace]", "True"}],
  SequenceForm[
  "** Option ", xAct`xTensor`AllowUpperDerivatives, " of ", 
   xAct`xTensor`ContractMetric, " changed from ", False, " to ", True],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** Option \"\>", "\[InvisibleSpace]", "MetricOn", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "MakeRule", 
   "\[InvisibleSpace]", "\<\" changed from \"\>", "\[InvisibleSpace]", "None",
    "\[InvisibleSpace]", "\<\" to \"\>", "\[InvisibleSpace]", "All"}],
  SequenceForm[
  "** Option ", xAct`xTensor`MetricOn, " of ", xAct`xTensor`MakeRule, 
   " changed from ", None, " to ", All],
  Editable->False]], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"** Option \"\>", "\[InvisibleSpace]", "ContractMetrics", 
   "\[InvisibleSpace]", "\<\" of \"\>", "\[InvisibleSpace]", "MakeRule", 
   "\[InvisibleSpace]", "\<\" changed from \"\>", "\[InvisibleSpace]", 
   "False", "\[InvisibleSpace]", "\<\" to \"\>", "\[InvisibleSpace]", "True"}],
  SequenceForm[
  "** Option ", xAct`xTensor`ContractMetrics, " of ", xAct`xTensor`MakeRule, 
   " changed from ", False, " to ", True],
  Editable->False]], "Print"]
}, Open  ]],

Cell[BoxData["\<\"xAct`xLightCone`\"\>"], "Output"]
}, Open  ]],

Cell[TextData[{
 "\nCheck version of ",
 StyleBox["xTensor",
  FontSlant->"Italic"],
 ". We simply compare dates:"
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"Not", "@", 
     RowBox[{"OrderedQ", "@", 
      RowBox[{"Map", "[", 
       RowBox[{"Last", ",", 
        RowBox[{"{", 
         RowBox[{"$xTensorVersionExpected", ",", "xAct`xTensor`$Version"}], 
         "}"}]}], "]"}]}]}], ",", 
    RowBox[{"Throw", "@", 
     RowBox[{"Message", "[", 
      RowBox[{
       RowBox[{"General", "::", "versions"}], ",", "\"\<xTensor\>\"", ",", 
       "xAct`xTensor`$Version", ",", "$xTensorVersionExpected"}], "]"}]}]}], 
   "]"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"If", "[", 
  RowBox[{
   RowBox[{"Not", "@", 
    RowBox[{"OrderedQ", "@", 
     RowBox[{"Map", "[", 
      RowBox[{"Last", ",", 
       RowBox[{"{", 
        RowBox[{"$xPertVersionExpected", ",", "xAct`xPert`$Version"}], 
        "}"}]}], "]"}]}]}], ",", 
   RowBox[{"Throw", "@", 
    RowBox[{"Message", "[", 
     RowBox[{
      RowBox[{"General", "::", "versions"}], ",", "\"\<xPert\>\"", ",", 
      "xAct`xPert`$Version", ",", "$xPertVersionExpected"}], "]"}]}]}], 
  "]"}]}], "Input",
 InitializationCell->True],

Cell["\<\

Welcome message:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Print", "[", 
   RowBox[{"\"\<Package xAct`xLight`  version \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<, \>\"", ",", 
    RowBox[{"$Version", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "Print", "[", 
   "\"\<CopyRight (C) 2015-, Obinna Umeh under the General Public \
License.\>\"", "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Package xAct`xLight`  version \"\>", 
   "\[InvisibleSpace]", "\<\"0.0.1\"\>", "\[InvisibleSpace]", "\<\", \"\>", 
   "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"2014", ",", "9", ",", "25"}], "}"}]}],
  SequenceForm["Package xAct`xLight`  version ", "0.0.1", ", ", {2014, 9, 25}],
  Editable->False]], "Print"],

Cell[BoxData["\<\"CopyRight (C) 2015-, Obinna Umeh under the General Public \
License.\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell["\<\

We specify the context xAct`xPand` to avoid overriding the Disclaimer of the \
other packages. However, we need to turn off the message General:shdw \
temporarily:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xAct`xPand`Disclaimer", "[", "]"}], ":=", 
  RowBox[{
  "Print", "[", 
   "\"\<These are points 11 and 12 of the General Public \
License:\\n\\nBECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO \
WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT \
WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES \
PROVIDE THE PROGRAM `AS IS\.b4 WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED \
OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF \
MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO \
THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM \
PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR \
CORRECTION.\\n\\nIN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO \
IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY \
AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR \
DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES \
ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT \
LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED \
BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER \
PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE \
POSSIBILITY OF SUCH DAMAGES.\>\"", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"On", "[", 
  RowBox[{"General", "::", "shdw"}], "]"}]}], "Input",
 InitializationCell->True],

Cell["\<\

If this is the last package show the GPL short disclaimer:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
    "xAct`xCore`Private`$LastPackage", "===", "\"\<xAct`xLightCone`\>\""}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Unset", "[", "xAct`xCore`Private`$LastPackage", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
     "Print", "[", 
      "\"\<These packages come with ABSOLUTELY NO WARRANTY; for details type \
Disclaimer[]. This is free software, and you are welcome to redistribute it \
under certain conditions. See the General Public License for details.\>\"", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Print", "[", "xAct`xCore`Private`bars", "]"}]}]}], "]"}], 
  ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"],

Cell[BoxData["\<\"These packages come with ABSOLUTELY NO WARRANTY; for \
details type Disclaimer[]. This is free software, and you are welcome to \
redistribute it under certain conditions. See the General Public License for \
details.\"\>"], "Print"],

Cell[BoxData["\<\"------------------------------------------------------------\
\"\>"], "Print"]
}, Open  ]]
}, Open  ]],

Cell["\<\

Note that symbols in the Global` context cannot be accessed while building \
the package:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData["$ContextPath"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"xAct`xLightCone`\"\>", ",", "\<\"xAct`xPert`\"\>", 
   ",", "\<\"xAct`xTensor`\"\>", ",", "\<\"xAct`xPerm`\"\>", 
   ",", "\<\"xAct`xCore`\"\>", ",", "\<\"xAct`ExpressionManipulation`\"\>", 
   ",", "\<\"System`\"\>"}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$Context"], "Input"],

Cell[BoxData["\<\"xAct`xLightCone`\"\>"], "Output"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.4. Set up", "Subsubsection"],

Cell["\<\

Prefix format for derivatives:\
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$CovDFormat", "=", "\"\<Prefix\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Message", "[", 
   RowBox[{
    RowBox[{"General", "::", "nostdvar"}], ",", "\"\<$CovDFormat\>\"", ",", 
    "\"\<Prefix\>\""}], "]"}], ";"}]}], "Input",
 InitializationCell->True],

Cell["\<\

We do not modify the option MathLink of CanonicalPerm:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Options", "[", "CanonicalPerm", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"MathLink", "\[RuleDelayed]", "$xpermQ"}], ",", 
   RowBox[{"TimeVerbose", "\[Rule]", "False"}], ",", 
   RowBox[{"xPermVerbose", "\[Rule]", "False"}], ",", 
   RowBox[{"OrderedBase", "\[Rule]", "True"}]}], "}"}]], "Output"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["$xpermQ"], "Input"],

Cell[BoxData["True"], "Output"]
}, Open  ]],

Cell["", "Text"]
}, Closed]],

Cell[CellGroupData[{

Cell["1.5. Usage and error messages", "Subsubsection"],

Cell["\<\

Versions:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"**", " ", "VERSIONS"}], " ", "***)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"$Version", "::", "usage"}], "=", 
     "\"\<$Version is a global variable giving the version of the package \
xPand in use.\>\""}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"$xTensorVersionExpected", "::", "usage"}], "=", 
     "\"\<$xTensorVersionExpected is a global variable giving the oldest \
possible version of the package xTensor which is required by the version of \
the package xPand in use.\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"$xPertVersionExpected", "::", "usage"}], "=", 
     "\"\<$xPertVersionExpected is a global variable giving the oldest \
possible version of the package xPert which is required by the version of the \
package xPand in use.\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True]
}, Open  ]],

Cell[CellGroupData[{

Cell["1.6. Begin private", "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Begin", "[", "\"\<xAct`xLightCone`Private`\>\"", "]"}]], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`xLightCone`Private`\"\>"], "Output"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "*", "Why", " ", "a", " ", "scalar", " ", "head", " ", "inside", " ", "a", 
    " ", "scalar", " ", 
    RowBox[{"function", "?"}]}], "**)"}], 
  RowBox[{"(*", 
   RowBox[{
   "*", "We", " ", "choose", " ", "that", " ", "the", " ", "Scalar", " ", 
    "head", " ", "should", " ", "be", " ", "removed"}], "**)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"Unprotect", "[", "xAct`xTensor`NoScalar", "]"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"xAct`xTensor`NoScalar", "[", 
     RowBox[{
      RowBox[{"f_", "?", "ScalarFunctionQ"}], "[", "expr_", "]"}], "]"}], ":=", 
    RowBox[{"f", "[", 
     RowBox[{"NoScalar", "@", "expr"}], "]"}]}], "\n", 
   RowBox[{
    RowBox[{"Protect", "[", "xAct`xTensor`NoScalar", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "*", "To", " ", "avoid", " ", "complaints", " ", "from", " ", "MakeRule", 
     " ", "when", " ", "the", " ", "rule", " ", "has", " ", "already", " ", 
     "been", " ", "defined", " ", "and", " ", "the", " ", "lhs", " ", "is", 
     " ", 
     RowBox[{"zero", "."}]}], "**)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"xAct`xTensor`MakeRule", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"lhs_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Evaluate", "[", "#", "]"}], "===", "0"}], "&"}], 
            ")"}]}], ",", "rhs_", ",", "conditions___"}], "}"}], ",", 
        RowBox[{"options", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"{", "}"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "We", " ", "create", " ", "our", " ", "own", " ", "function", " ", 
      "based", " ", "on", " ", "MakeRule"}], ",", 
     RowBox[{
     "but", " ", "separating", " ", "the", " ", "special", " ", "problematic",
       " ", 
      RowBox[{"case", ".", "This"}], " ", "avoids", " ", "overloading", " ", 
      "a", " ", "definition", " ", "from", " ", 
      RowBox[{"xTensor", ".", "It"}], " ", "does", " ", "not", " ", "change", 
      " ", "the", " ", "way", " ", "xPand", " ", "works"}], ",", 
     RowBox[{"but", " ", "that", " ", "way"}], ",", 
     RowBox[{
     "the", " ", "code", " ", "is", " ", "clearly", " ", "separated", " ", 
      "from", " ", 
      RowBox[{"xTensor", ".", "This"}], " ", "is", " ", "a", " ", "much", " ",
       "more", " ", "polite", " ", "way", " ", "to", " ", "modify", " ", 
      "the", " ", "behaviour", " ", "of", " ", 
      RowBox[{"xTensor", ".", "This"}], " ", "method", " ", "was", " ", 
      "advised", " ", "by", " ", "Leo", " ", "Stein"}]}], "**)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"SetAttributes", "[", 
    RowBox[{"BuildRule", ",", "HoldFirst"}], "]"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BuildRule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lhs_", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Evaluate", "[", "#", "]"}], "===", "0"}], "&"}], 
           ")"}]}], ",", "rhs_", ",", "conditions___"}], "}"}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BuildRule", "[", 
      RowBox[{"{", 
       RowBox[{"lhs_", ",", "rhs_", ",", "conditions___"}], "}"}], "]"}], ":=", 
     RowBox[{"MakeRule", "[", 
      RowBox[{"{", 
       RowBox[{"lhs", ",", "rhs", ",", "conditions"}], "}"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BuildRule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lhs_", ",", "rhs_", ",", "conditions___"}], "}"}], ",", 
       RowBox[{"options", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"MakeRule", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"lhs", ",", "rhs", ",", "conditions"}], "}"}], ",", 
       "options"}], "]"}]}], ";"}]}]}]], "Input"],

Cell["Default options and protected names", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "DEFAULT"}], " ", "OPTIONS", " ", "AND", " ", "PROTECTED", 
    " ", "NAMES"}], "***)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"BackgroundFieldMethod", "=", "False"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$DebugInfoQ", "=", "False"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$CommutecdRules", "=", 
     RowBox[{"{", "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$ConformalTime", "=", "True"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$FirstOrderVectorPerturbations", "=", "True"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$FirstOrderTensorPerturbations", "=", "True"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$OpenConstantsOfStructure", "=", "True"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$PrePrint", "=", "ScreenDollarIndices"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"$SortCovDAutomatic", "=", "True"}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Off", "[", 
     RowBox[{"RuleDelayed", "::", "rhs"}], "]"}], ";"}]}]}]], "Input"],

Cell["Private Boolean function inherited from xPand", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"**", "PRIVATE"}], " ", "BOOLEAN", " ", "FUNCTIONS"}], "***)"}], 
  RowBox[{"(*", 
   RowBox[{"*", "Miscellaneous"}], "**)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"$DefInfoQ", "=", "True"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", " ", "set", " ", 
      RowBox[{"to", "'"}], 
      RowBox[{"False", "'"}]}], ",", 
     RowBox[{
     "the", " ", "information", " ", "messages", " ", "are", " ", "not", " ", 
      
      RowBox[{"printed", "."}]}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"*", "Testing", " ", "expressions"}], "**)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"AnyIndicesListQ", "[", "inds_List", "]"}], ":=", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"inds", ",", 
       RowBox[{"AnyIndices", "[", "_", "]"}]}], "]"}], "=!=", 
     RowBox[{"{", "}"}]}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "If", " ", "the", " ", "list", " ", "of", " ", "indices", " ", 
      "contains", " ", "the", " ", 
      RowBox[{"head", "'"}], 
      RowBox[{"AnyIndices", "'"}]}], ",", 
     RowBox[{
      RowBox[{"then", " ", 
       RowBox[{"AnyIndicesListQ", "[", "inds", "]"}], " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{"True", "'"}]}], ";", 
      RowBox[{"otherwise", " ", "it", " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{
        RowBox[{"False", "'"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"DefTensorQ", "[", "symb_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"$Tensors", ",", "symb"}], "]"}], "===", 
     RowBox[{"{", "symb", "}"}]}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "'"}], 
      RowBox[{"symb", "'"}], " ", "has", " ", "been", " ", "defined", " ", 
      "as", " ", "a", " ", "tensor"}], ",", 
     RowBox[{
      RowBox[{"then", " ", 
       RowBox[{"DefTensorQ", "[", "symb", "]"}], " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{"True", "'"}]}], ";", 
      RowBox[{"otherwise", " ", "it", " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{
        RowBox[{"False", "'"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"GaugeQ", "[", "strg_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<AnyGauge\>\"", ",", "\"\<ComovingGauge\>\"", ",", 
         "\"\<FlatGauge\>\"", ",", "\"\<IsoDensityGauge\>\"", ",", 
         "\"\<NewtonGauge\>\"", ",", "\"\<SynchronousGauge\>\""}], "}"}], ",",
        "strg"}], "]"}], "===", 
     RowBox[{"{", "strg", "}"}]}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "'"}], 
      RowBox[{"strg", "'"}], " ", "matches", " ", "one", " ", "of", " ", 
      "the", " ", "element", " ", "in", " ", "the", " ", "list"}], ",", 
     RowBox[{
      RowBox[{"then", " ", 
       RowBox[{"GaugeQ", "[", "strg", "]"}], " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{"True", "'"}]}], ";", 
      RowBox[{"otherwise", " ", "it", " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{
        RowBox[{"False", "'"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"InducedMetricQ", "[", "symb_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"MetricQ", "[", "symb", "]"}], ",", 
      RowBox[{
       RowBox[{"InducedFrom", "[", "symb", "]"}], "=!=", "Null"}], ",", 
      "False"}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "'"}], 
      RowBox[{"symb", "'"}], " ", "is", " ", "not", " ", "defined", " ", "as",
       " ", "a", " ", "metric"}], ",", 
     RowBox[{"then", " ", 
      RowBox[{"InducedMetricQ", "[", "symb", "]"}], " ", 
      RowBox[{"returns", "'"}], 
      RowBox[{
       RowBox[{"False", "'"}], ".", "Otherwise"}]}], ",", 
     RowBox[{"it", " ", "checks", " ", 
      RowBox[{"whether", "'"}], 
      RowBox[{"symb", "'"}], " ", "is", " ", "an", " ", "induced", " ", 
      RowBox[{"metric", ".", "If"}], " ", "this", " ", "is", " ", "the", " ", 
      "case"}], ",", 
     RowBox[{
      RowBox[{"then", " ", 
       RowBox[{"InducedMetricQ", "[", "symb", "]"}], " ", 
       RowBox[{"gives", "'"}], 
       RowBox[{"True", "'"}]}], ";", 
      RowBox[{"otherwise", " ", "it", " ", 
       RowBox[{"gives", "'"}], 
       RowBox[{
        RowBox[{"False", "'"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SpaceTimeQ", "[", "strg_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<Anisotropic\>\"", ",", "\"\<BianchiB\>\"", ",", 
         "\"\<BianchiA\>\"", ",", "\"\<BianchiI\>\"", ",", "\"\<FLCurved\>\"",
          ",", "\"\<FLFlat\>\"", ",", "\"\<Minkowski\>\""}], "}"}], ",", 
       "strg"}], "]"}], "===", 
     RowBox[{"{", "strg", "}"}]}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "'"}], 
      RowBox[{"strg", "'"}], " ", "matches", " ", "one", " ", "of", " ", 
      "the", " ", "element", " ", "of", " ", "the", " ", "list"}], ",", 
     RowBox[{
      RowBox[{"then", " ", 
       RowBox[{"SpaceTimeQ", "[", "strg", "]"}], " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{"True", "'"}]}], ";", 
      RowBox[{"otherwise", " ", "it", " ", 
       RowBox[{"returns", "'"}], 
       RowBox[{
        RowBox[{"False", "'"}], "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorNullQ", "[", "tens_", "]"}], ":=", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"SlotsOfTensor", "[", "tens", "]"}], ",", "Labels"}], "]"}], 
       "=!=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"Print", "[", 
       RowBox[{
       "\"\<** Warning: the function TensorNullQ is only suited to test \
tensors defined without label-indices. \>\"", ",", "tens"}], "]"}], ",", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"inds", "=", 
          RowBox[{"DummyIn", "/@", 
           RowBox[{"SlotsOfTensor", "[", "tens", "]"}]}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"tens", "@@", "inds"}], "===", "0"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TensorNullQ", "[", "tens", "]"}], " ", 
      RowBox[{"returns", "'"}], 
      RowBox[{"True", "'"}], " ", 
      RowBox[{"if", "'"}], 
      RowBox[{"tens", "'"}], " ", "is", " ", "a", " ", "null", " ", "tensor", 
      " ", 
      RowBox[{"and", "'"}], 
      RowBox[{"False", "'"}], " ", 
      RowBox[{"otherwise", ".", "This"}], " ", "function", " ", "is", " ", 
      "not", " ", "suited", " ", "to", " ", "test", " ", "tensors", " ", 
      "defined", " ", "with", " ", "label"}], "-", 
     RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"*", "Type", " ", "of", " ", "manifolds"}], "**)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"BianchiBool", "[", "Spacetype_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Spacetype", "===", "\"\<BianchiB\>\""}], "||", 
      RowBox[{"Spacetype", "===", "\"\<BianchiA\>\""}], "||", 
      RowBox[{"Spacetype", "===", "\"\<BianchiI\>\""}]}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{"FlatSpaceBool", "[", "Spacetype_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Spacetype", "===", "\"\<BianchiI\>\""}], "||", 
      RowBox[{"Spacetype", "===", "\"\<FLFlat\>\""}], "||", 
      RowBox[{"Spacetype", "===", "\"\<Minkowski\>\""}]}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{"NoAnisotropyBool", "[", "Spacetype_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Spacetype", "===", "\"\<FLCurved\>\""}], "||", 
      RowBox[{"Spacetype", "===", "\"\<FLFlat\>\""}], "||", 
      RowBox[{"Spacetype", "===", "\"\<Minkowski\>\""}]}], ")"}]}], "\n", 
   RowBox[{
    RowBox[{"AnisotropyBool", "[", "Spacetype_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"Spacetype", "===", "\"\<Anisotropic\>\""}], ")"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{"The", " ", 
     RowBox[{"name", "'"}], 
     RowBox[{"AnisotropyBool", "'"}], " ", "should", " ", "be", " ", 
     RowBox[{"changed", "."}]}], "*)"}]}]}]], "Input"],

Cell["\<\
I am rtrying to modify SetSlicing to include decomposition on the \
ScreenSpace. I have changed the name but it is mainly composed on 
SetSlicing functionalities. \
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetSlicingUpToScreenSpace", "[", 
   RowBox[{
    RowBox[{"g_", "?", "MetricQ"}], ",", "u_", ",", 
    RowBox[{"normu_:", "-", "1"}], ",", "h_", ",", "cd_", ",", 
    RowBox[{"{", 
     RowBox[{"cdpost_String", ",", "cdpre_String"}], "}"}], ",", "n_", ",", 
    RowBox[{"normn_:", "1"}], ",", "NSS_", ",", "cd2_", ",", 
    RowBox[{"{", 
     RowBox[{"cd2post_String", ",", "cd2pre_String"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "m", ",", "p", ",", "q", ",", "DummyS", ",", "DummyV", ",", "DummyT", 
      ",", "ui", ",", "indsdimminustwo", ",", "indsdim", ",", "dim", ",", 
      "prot", ",", "Silenth"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Manifold", "=", 
         RowBox[{"ManifoldOfCovD", "@", 
          RowBox[{"CovDOfMetric", "[", "g", "]"}]}]}], ",", 
        RowBox[{"CD", "=", 
         RowBox[{"CovDOfMetric", "[", "g", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"dim", "=", 
        RowBox[{"DimOfManifold", "[", "Manifold", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ind1", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"ind2", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"ind3", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"ind4", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"ind5", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"ind6", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"ind7", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"i1", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"i2", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"i3", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"i4", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"i5", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}], ",", 
           RowBox[{"dummy", "=", 
            RowBox[{"DummyIn", "[", 
             RowBox[{"Tangent", "[", "Manifold", "]"}], "]"}]}]}], "}"}], ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
          "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"DefTensor", "[", 
            RowBox[{
             RowBox[{"u", "[", 
              RowBox[{"-", "ind1"}], "]"}], ",", 
             RowBox[{"{", "Manifold", "}"}], ",", 
             RowBox[{"PrintAs", "\[Rule]", 
              RowBox[{"\"\<\\!\\(\>\"", "<>", 
               RowBox[{"ToString", "[", "ind1", "]"}], "<>", 
               "\"\<\\&-\\)\>\""}]}]}], "]"}], "\n", "        ", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Induced", " ", "Metric"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Off", "[", 
            RowBox[{"DefMetric", "::", "old"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"DefMetric", "[", 
           RowBox[{"1", ",", 
            RowBox[{"h", "[", 
             RowBox[{
              RowBox[{"-", "ind1"}], ",", 
              RowBox[{"-", "ind2"}]}], "]"}], ",", "cd", ",", 
            RowBox[{"{", 
             RowBox[{"cdpost", ",", "cdpre"}], "}"}], ",", 
            RowBox[{"InducedFrom", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"g", ",", "u"}], "}"}]}], ",", 
            RowBox[{"PrintAs", "\[Rule]", 
             RowBox[{"\"\<\\!\\(\>\"", "<>", 
              RowBox[{"ToString", "[", "h", "]"}], "<>", 
              "\"\<\\&-\\)\>\""}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Another", " ", "induced", " ", "metric"}], ",", " ", 
            RowBox[{
            "I", " ", "used", " ", "the", " ", "cd", " ", "for", " ", "the", 
             " ", "angular", " ", "derivative"}], ",", " ", 
            RowBox[{
            "it", " ", "is", " ", "cheating", " ", "I", " ", "will", " ", 
             "sort", " ", "it", " ", "later"}]}], "*)"}], 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"DefTensor", "[", 
            RowBox[{
             RowBox[{"n", "[", 
              RowBox[{"-", "ind1"}], "]"}], ",", 
             RowBox[{"{", "Manifold", "}"}], ",", 
             RowBox[{"OrthogonalTo", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"u", "[", "ind1", "]"}], "}"}]}], ",", 
             RowBox[{"ProjectedWith", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"h", "[", 
                RowBox[{"ind1", ",", 
                 RowBox[{"-", "ind2"}]}], "]"}], "}"}]}], ",", 
             RowBox[{"PrintAs", "\[Rule]", 
              RowBox[{"\"\<\\!\\(\>\"", "<>", 
               RowBox[{"ToString", "[", "n", "]"}], "<>", 
               "\"\<\\&-\\)\>\""}]}]}], "]"}], "\[IndentingNewLine]", 
           "\[IndentingNewLine]", 
           RowBox[{"DefMetric", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Silenth", "[", 
              RowBox[{
               RowBox[{"-", "ind1"}], ",", 
               RowBox[{"-", "ind2"}]}], "]"}], ",", "cd2", ",", 
             RowBox[{"{", 
              RowBox[{"cd2post", ",", "cd2pre"}], "}"}], ",", 
             RowBox[{"InducedFrom", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"g", ",", "n"}], "}"}]}], ",", 
             RowBox[{"PrintAs", "\[Rule]", 
              RowBox[{"\"\<\\!\\(\>\"", "<>", 
               RowBox[{"ToString", "[", "h", "]"}], "<>", 
               "\"\<\\&-\\)\>\""}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "I", " ", "use", " ", "NSS", " ", "as", " ", "the", " ", 
              "screen", " ", "space", " ", "metric", " ", "because", " ", 
              "the", " ", "Silent", " ", "metric", " ", "is", " ", "3"}], "-",
              "D"}], ",", " ", 
            RowBox[{
            "I", " ", "will", " ", "clean", " ", "up", " ", "these", " ", 
             "later"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"DefTensor", "[", 
           RowBox[{
            RowBox[{"NSS", "[", 
             RowBox[{
              RowBox[{"-", "ind1"}], ",", 
              RowBox[{"-", "ind2"}]}], "]"}], ",", 
            RowBox[{"{", "Manifold", "}"}], ",", 
            RowBox[{"Symmetric", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "ind1"}], ",", 
               RowBox[{"-", "ind2"}]}], "}"}], "]"}], ",", 
            RowBox[{"OrthogonalTo", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"u", "[", "ind1", "]"}], ",", 
               RowBox[{"u", "[", "ind2", "]"}], ",", 
               RowBox[{"n", "[", "ind1", "]"}], ",", 
               RowBox[{"n", "[", "ind2", "]"}]}], "}"}]}], ",", 
            RowBox[{"ProjectedWith", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"h", "[", 
                RowBox[{"ind1", ",", 
                 RowBox[{"-", "ind4"}]}], "]"}], ",", 
               RowBox[{"h", "[", 
                RowBox[{"ind2", ",", 
                 RowBox[{"-", "ind5"}]}], "]"}], ",", 
               RowBox[{"Silenth", "[", 
                RowBox[{"ind1", ",", 
                 RowBox[{"-", "ind4"}]}], "]"}], ",", 
               RowBox[{"Silenth", "[", 
                RowBox[{"ind2", ",", 
                 RowBox[{"-", "ind5"}]}], "]"}]}], "}"}]}], ",", 
            RowBox[{"PrintAs", "\[Rule]", 
             RowBox[{"\"\<\\!\\(\>\"", "<>", 
              RowBox[{"ToString", "[", "NSS", "]"}], "<>", 
              "\"\<\\&-\\)\>\""}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "I", " ", "used", " ", "AutomaticRule", " ", "to", " ", "assign", 
             " ", "rules", " ", "to", " ", "NSS"}], "..."}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Well", " ", "it", " ", 
            RowBox[{"doesn", "'"}], "t", " ", "work", " ", "well"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"NSS", "[", 
              RowBox[{
               RowBox[{"-", "ind1"}], ",", 
               RowBox[{"-", "ind2"}]}], "]"}], "^:=", 
             RowBox[{"2", "/;", 
              RowBox[{
               RowBox[{"ind1", "+", "ind2"}], "\[Equal]", "0"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"NSS", "[", 
               RowBox[{
                RowBox[{"-", "ind1"}], ",", 
                RowBox[{"-", "ind2"}]}], "]"}], 
              RowBox[{"NSS", "[", 
               RowBox[{"ind1", ",", "ind2"}], "]"}]}], "^:=", "2"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"AutomaticRules", "[", 
            RowBox[{"NSS", ",", 
             RowBox[{"MakeRule", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NSS", "[", 
                 RowBox[{
                  RowBox[{"-", "ind1"}], ",", 
                  RowBox[{"-", "ind2"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{"h", "[", 
                  RowBox[{
                   RowBox[{"-", "ind1"}], ",", 
                   RowBox[{"-", "ind2"}]}], "]"}], "-", 
                 RowBox[{
                  RowBox[{"n", "[", 
                   RowBox[{"-", "ind1"}], "]"}], 
                  RowBox[{"n", "[", 
                   RowBox[{"-", "ind2"}], "]"}]}]}]}], "}"}], "]"}]}], "]"}], 
           "*)"}], 
          RowBox[{"AutomaticRules", "[", 
           RowBox[{"NSS", ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"NSS", "[", 
                 RowBox[{"ind1", ",", "ind2"}], "]"}], " ", 
                RowBox[{"NSS", "[", 
                 RowBox[{
                  RowBox[{"-", "ind2"}], ",", 
                  RowBox[{"-", "ind3"}]}], "]"}]}], ",", 
               RowBox[{"NSS", "[", 
                RowBox[{"ind1", ",", 
                 RowBox[{"-", "ind3"}]}], "]"}]}], "}"}], "]"}]}], "]"}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AutomaticRules", "[", 
           RowBox[{"NSS", ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"NSS", "[", 
                 RowBox[{
                  RowBox[{"-", "ind1"}], ",", 
                  RowBox[{"-", "ind2"}]}], "]"}], " ", 
                RowBox[{"NSS", "[", 
                 RowBox[{"ind2", ",", "ind3"}], "]"}]}], ",", 
               RowBox[{"NSS", "[", 
                RowBox[{
                 RowBox[{"-", "ind1"}], ",", "ind3"}], "]"}]}], "}"}], 
             "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"AutomaticRules", "[", 
           RowBox[{"NSS", ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"NSS", "[", 
                RowBox[{
                 RowBox[{"-", "ind1"}], ",", "ind1"}], "]"}], " ", ",", "2"}],
               "}"}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"On", "[", 
           RowBox[{"DefMetric", "::", "old"}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "We", " ", "remove", " ", "automatic", " ", "Leibniz", " ", "rule",
             " ", "when", " ", "there", " ", "is", " ", "a", " ", "Scalar", 
            " ", 
            RowBox[{"Head", ".", "This"}], " ", "is", " ", "to", " ", 
            "ensure", " ", "that", " ", "the", " ", "induced", " ", 
            "derivative", " ", "does", " ", "not", " ", "spoil", " ", 
            RowBox[{"an", "'"}], 
            RowBox[{"InducedDecomposition", "'"}]}], "*)"}], 
          RowBox[{"prot", "=", 
           RowBox[{"Unprotect", "[", "cd", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cd", "[", "a_", "]"}], "[", 
            RowBox[{"Scalar", "[", "expr_", "]"}], "]"}], "=."}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"cd2", "[", "a_", "]"}], "[", 
            RowBox[{"Scalar", "[", "expr_", "]"}], "]"}], "=."}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Protect", "[", "prot", "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$Rulecdh", "[", "h1_", "]"}], ":=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{
                 RowBox[{"-", "a_"}], ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", "a_", "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", 
                 RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{"b_", ",", 
                 RowBox[{"-", "a_"}]}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", "a_", "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{"b_", ",", "a_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", 
                 RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{
                 RowBox[{"-", "a_"}], ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd", "[", "a_", "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd", "[", 
                  RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{"b_", ",", 
                 RowBox[{"-", "a_"}]}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd", "[", "a_", "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"h1", "[", 
                RowBox[{"b_", ",", "a_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd", "[", 
                  RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd", "[", "b", "]"}], "[", "expr1", "]"}]}]}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"$Rulecdh", "[", "NSS1_", "]"}], ":=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"NSS1", "[", 
                RowBox[{
                 RowBox[{"-", "a_"}], ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", "a_", "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NSS", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", 
                 RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NSS1", "[", 
                RowBox[{"b_", ",", 
                 RowBox[{"-", "a_"}]}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", "a_", "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NSS", "[", 
                RowBox[{"b_", ",", "a_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", 
                 RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{"NSS1", "[", 
                RowBox[{
                 RowBox[{"-", "a_"}], ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd2", "[", "a_", "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}]}], ",", 
             
             RowBox[{
              RowBox[{
               RowBox[{"NSS1", "[", 
                RowBox[{"a_", ",", "b_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd2", "[", 
                  RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}]}], ",", 
             
             RowBox[{
              RowBox[{
               RowBox[{"NSS1", "[", 
                RowBox[{"b_", ",", 
                 RowBox[{"-", "a_"}]}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd2", "[", "a_", "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}]}], ",", 
             
             RowBox[{
              RowBox[{
               RowBox[{"NSS1", "[", 
                RowBox[{"b_", ",", "a_"}], "]"}], " ", 
               RowBox[{
                RowBox[{"cd2", "[", "c_", "]"}], "@", 
                RowBox[{
                 RowBox[{"cd2", "[", 
                  RowBox[{"-", "a_"}], "]"}], "[", "expr1_", "]"}]}]}], 
              "\[RuleDelayed]", 
              RowBox[{
               RowBox[{"cd2", "[", "c", "]"}], "@", 
               RowBox[{
                RowBox[{"cd2", "[", "b", "]"}], "[", "expr1", "]"}]}]}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]",
           "\n", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"SpaceType", "[", "h", "]"}], "^=", "SpaceTimeType"}], 
            ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "default", " ", "positionof", " ", "indices", " ", 
            "for", " ", "the", " ", "extrinsic", " ", "curvature", " ", "and",
             " ", "the", " ", "acceleration", " ", "is", " ", "down"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SlotsOfTensor", "[", "#", "]"}], "^:=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Tangent", "[", "Manifold", "]"}]}], ",", 
                RowBox[{"-", 
                 RowBox[{"Tangent", "[", "Manifold", "]"}]}]}], "}"}]}], 
             ")"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"ExtrinsicK", "[", "h", "]"}], "}"}]}], ";", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SlotsOfTensor", "[", "#", "]"}], "^:=", 
              RowBox[{"{", 
               RowBox[{"-", 
                RowBox[{"Tangent", "[", "Manifold", "]"}]}], "}"}]}], ")"}], 
            "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"Acceleration", "[", "u", "]"}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SlotsOfTensor", "[", "#", "]"}], "^:=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", 
                 RowBox[{"Tangent", "[", "Manifold", "]"}]}], ",", 
                RowBox[{"-", 
                 RowBox[{"Tangent", "[", "Manifold", "]"}]}]}], "}"}]}], 
             ")"}], "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"ExtrinsicK", "[", "Silenth", "]"}], "}"}]}], ";", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"SlotsOfTensor", "[", "#", "]"}], "^:=", 
              RowBox[{"{", 
               RowBox[{"-", 
                RowBox[{"Tangent", "[", "Manifold", "]"}]}], "}"}]}], ")"}], 
            "&"}], "/@", 
           RowBox[{"{", 
            RowBox[{"Acceleration", "[", "n", "]"}], "}"}]}], ";", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "The", " ", "acceleration", " ", "should", " ", "vanish", " ", 
            "for", " ", "homogeneous", " ", 
            RowBox[{"spacetimes", "."}]}], "*)"}], "\[IndentingNewLine]", 
          "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"Acceleration", "[", "u", "]"}], "[", "ind1_", "]"}], "=",
            "0"}], ";", "\n", 
          RowBox[{"AutomaticRules", "[", 
           RowBox[{"u", ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"u", "[", "ind1", "]"}], " ", 
                RowBox[{"u", "[", 
                 RowBox[{"-", "ind1"}], "]"}]}], ",", "normu"}], "}"}], 
             "]"}]}], "]"}], ";", "\n", 
          RowBox[{"AutomaticRules", "[", 
           RowBox[{"u", ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"u", "[", 
                 RowBox[{"-", "ind1"}], "]"}], " ", 
                RowBox[{"g", "[", 
                 RowBox[{"ind1", ",", "ind2"}], "]"}]}], ",", 
               RowBox[{"u", "[", "ind2", "]"}]}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"AutomaticRules", "[", 
             RowBox[{"u", ",", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"ind1", ",", "ind2"}], "]"}], " ", 
                  RowBox[{"u", "[", 
                   RowBox[{"-", "ind2"}], "]"}], " ", 
                  RowBox[{"u", "[", 
                   RowBox[{"-", "ind1"}], "]"}]}], ",", "normu"}], "}"}], 
               "]"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", "\n", 
          RowBox[{
           RowBox[{
            RowBox[{"Acceleration", "[", "n", "]"}], "[", "ind1_", "]"}], "=",
            "0"}], ";", "\n", 
          RowBox[{"AutomaticRules", "[", 
           RowBox[{"n", ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "[", "ind1", "]"}], " ", 
                RowBox[{"n", "[", 
                 RowBox[{"-", "ind1"}], "]"}]}], ",", "normn"}], "}"}], 
             "]"}]}], "]"}], ";", "\n", 
          RowBox[{"AutomaticRules", "[", 
           RowBox[{"n", ",", 
            RowBox[{"MakeRule", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"n", "[", 
                 RowBox[{"-", "ind1"}], "]"}], " ", 
                RowBox[{"g", "[", 
                 RowBox[{"ind1", ",", "ind2"}], "]"}]}], ",", 
               RowBox[{"n", "[", "ind2", "]"}]}], "}"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"AutomaticRules", "[", 
             RowBox[{"n", ",", 
              RowBox[{"MakeRule", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"g", "[", 
                   RowBox[{"ind1", ",", "ind2"}], "]"}], " ", 
                  RowBox[{"n", "[", 
                   RowBox[{"-", "ind2"}], "]"}], " ", 
                  RowBox[{"n", "[", 
                   RowBox[{"-", "ind1"}], "]"}]}], ",", "normn"}], "}"}], 
               "]"}]}], "]"}], ";"}], "*)"}], "\n", "\[IndentingNewLine]", 
          "\n", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"IntegerQ", "@", "dim"}], "&&", 
             RowBox[{"dim", "\[GreaterEqual]", "2"}]}], ",", 
            RowBox[{
             RowBox[{"indsdim", "=", 
              RowBox[{"GetIndicesOfVBundle", "[", 
               RowBox[{
                RowBox[{"Tangent", "@", "Manifold"}], ",", "dim", ",", 
                RowBox[{"{", "ind5", "}"}]}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"AutomaticRules", "[", 
              RowBox[{
               RowBox[{"epsilon", "[", "g", "]"}], ",", 
               RowBox[{"MakeRule", "[", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{"epsilon", "[", "g", "]"}], "@@", "indsdim"}], 
                    " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"-", 
                    RowBox[{"indsdim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], " ", 
                    RowBox[{"h", "[", 
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"indsdim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}]}], ",", "ind5"}], "]"}]}], 
                   ",", 
                   RowBox[{
                    RowBox[{"ReplaceIndex", "[", 
                    RowBox[{
                    RowBox[{"Evaluate", "[", 
                    RowBox[{
                    RowBox[{"epsilon", "[", "g", "]"}], "@@", "indsdim"}], 
                    "]"}], ",", 
                    RowBox[{
                    RowBox[{"indsdim", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", "ind5"}]}], 
                    "]"}], " ", 
                    RowBox[{"u", "[", 
                    RowBox[{"-", 
                    RowBox[{"indsdim", "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}]}], "}"}], "]"}],
                 "]"}]}], "]"}], ";"}]}], "]"}], ";"}]}], "]"}]}]}], "]"}]}], 
   "]"}]}]], "Input"],

Cell["\<\
This is an ad-hoc form of induced decomposition, I will still optimaze it \
further \
\>", "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ToInducedDerivativeScreenSpace", "[", 
   RowBox[{"expr_", ",", "supercd_", ",", "cd_"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"ToInducedDerivative", "[", 
   RowBox[{"expr", ",", "supercd", ",", "cd"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ToInducedDerivativeScreenSpace", "[", 
   RowBox[{"expr_", ",", "supercd_", ",", "cd_", ",", "cd2_"}], "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{
    RowBox[{
     RowBox[{"supercd", "[", "ind_", "]"}], "[", 
     RowBox[{"expr1", ":", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"_", "?", "xTensorQ"}], "[", "___", "]"}], "|", 
        RowBox[{
         RowBox[{"_", "?", "InertHeadQ"}], "[", "___", "]"}], "|", 
        RowBox[{
         RowBox[{"cd", "[", "_", "]"}], "[", "_", "]"}], "|", 
        RowBox[{
         RowBox[{"LieD", "[", "_", "]"}], "[", "_", "]"}]}], ")"}]}], "]"}], 
    "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{
       RowBox[{"cd", "[", "ind", "]"}], "[", "expr1", "]"}]}], "+", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"frees", "=", 
         RowBox[{"FindFreeIndices", "[", "expr1", "]"}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ToInducedDerivative", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"supercd", "[", "ind", "]"}], "[", "expr1", "]"}], ",", 
          "supercd", ",", "cd"}], "]"}], "+", 
        RowBox[{"ToInducedDerivative", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"cd", "[", "ind", "]"}], "[", "expr1", "]"}], ",", "cd", 
          ",", "cd2"}], "]"}]}]}], "]"}]}]}]}]}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["End private and package",
 FontColor->RGBColor[0, 0, 1]]], "Subsubsection"],

Cell[BoxData[
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{"RuleDelayed", "::", "rhs"}], "]"}], ";"}]], "Input",
 InitializationCell->True],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"End", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"EndPackage", "[", "]"}]}], "Input",
 InitializationCell->True],

Cell[BoxData["\<\"xAct`xLightCone`Private`\"\>"], "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowSize->{1081, 860},
WindowMargins->{{16, Automatic}, {Automatic, 80}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
ShowSelection->True,
TrackCellChangeTimes->False,
Magnification->1,
FrontEndVersion->"9.0 for Linux x86 (32-bit) (February 7, 2013)",
StyleDefinitions->FrontEnd`FileName[{"Creative"}, "PastelColor.nb", 
  CharacterEncoding -> "UTF-8"]
]

